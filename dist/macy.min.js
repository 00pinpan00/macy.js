/*!
 * Macy.js v0.1.0 - description here
 * Author: Copyright (c) Big Bite Creative <@bigbitecreative> <http://bigbitecreative.com>
 * Url: 
 * License: MIT
 */
!function(n,t){"function"==typeof define&&define.amd?define([],function(){return t()}):"object"==typeof exports?module.exports=t():n.Macy=t()}(this,function(){"use strict";var n=function(t){var e,r={},o=1,i=function(t){for(e in t)Object.prototype.hasOwnProperty.call(t,e)&&(r[e]="[object Object]"===Object.prototype.toString.call(t[e])?n(r[e],t[e]):t[e])};for(i(arguments[0]),o=1;o<arguments.length;o++){var u=arguments[o];i(u)}return r},t={};t.VERSION="0.1.0",t.settings={};var e,r,o={columns:3,margin:2,trueOrder:!0,waitForImages:!1},i={options:{}},u=function(){var n,t=document.body.clientWidth;for(var e in i.options.breakAt)if(e>t){n=i.options.breakAt[e];break}return n||(n=i.options.columns),n},a=function(n){n="undefined"!=typeof n?n:!0;var t,e=u();return n?1===e?"100%":(t=(e-1)*i.options.margin/e,"calc("+100/e+"% - "+t+"px)"):100/e},f=function(){var n=a();O(i.elements,function(t,e){e.style.width=n,e.style.position="absolute"})},c=function(n){var t,e,r=u(),o=0;return n++,1===n?0:(t=(i.options.margin-(r-1)*i.options.margin/r)*(n-1),o+=a(!1)*(n-1),e="calc("+o+"% + "+t+"px)")},s=function(n,t,e){var r=0;if(0===n)return 0;for(var o=0;n>o;o++)r+=parseInt(h(i.elements[e[o]],"height").replace("px","")),r+=i.options.margin;return r},l=function(n){var t=0,e=[],r=[],o=[];O(i.elements,function(o){t++,t>n&&(t=1,e.push(r),r=[]),r.push(o)}),e.push(r);for(var u=0,a=e.length;a>u;u++)for(var f=e[u],c=0,s=f.length;s>c;c++)o[c]="undefined"==typeof o[c]?[]:o[c],o[c].push(f[c]);i.rows=o,v(!1)},p=function(n){for(var t=i.elements,e=[],r=[],o=0;n>o;o++)e[o]=[];for(var u=0;u<t.length;u++)r.push(u);for(var a=0,f=r.length;f>a;a++){var c=d(e);e[c]="undefined"==typeof e[c]?[]:e[c],e[c].push(r[a])}i.rows=e,v(!0)},v=function(n){n=n||!1;for(var t=i.elements,e=i.rows,r=0,o=e.length;o>r;r++)for(var u=n?w(e[r]):e[r],a=0,f=u.length;f>a;a++){var l,p;l=c(r),p=s(a,r,u,n),t[u[a]].style.top=p+"px",t[u[a]].style.left=l}},d=function(n){for(var t,e,r,o=0,u=0,a=n.length;a>u;u++){for(var f=0;f<n[u].length;f++)o+=parseInt(h(i.elements[n[u][f]],"height").replace("px",""));r=e,e=void 0===e?o:e>o?o:e,(void 0===r||r>e)&&(t=u),o=0}return t},h=function(n,t){return window.getComputedStyle(n,null).getPropertyValue(t)},g=function(){for(var n=i.rows,t=0,e=0,r=0,o=n.length;o>r;r++){for(var u=0;u<n[r].length;u++)e+=parseInt(h(i.elements[n[r][u]],"height").replace("px","")),e+=0!==u?i.options.margin:0;t=e>t?e:t,e=0}return t},m=function(){var n=u();return 1===n?(i.container.style.height="auto",void O(i.elements,function(n,t){t.removeAttribute("style")})):(f(),i.elements=i.container.children,i.options.trueOrder?(l(n),void y()):(p(n),void y()))},y=function(){i.container.style.height=g()+"px"},w=function(n){for(var t=n,e=t.length-1,r=0;e>r;r++)for(var o=0;e>o;o++)if(t[o]>t[o+1]){var i=t[o];t[o]=t[o+1],t[o+1]=i}return t},b=function(n){return document.querySelector(n)},x=function(n){for(var t=document.querySelectorAll(n),e=[],r=t.length-1;r>=0;r--)null!==t[r].offsetParent&&e.unshift(t[r]);return e},O=function(n,t){for(var e=0,r=n.length;r>e;e++)t(e,n[e])},I=function(n,t){n=n||!1,t=t||!1,"function"==typeof n&&n(),r>=e&&"function"==typeof t&&t()},j=function(n,t){var o=x("img");e=o.length-1,r=0,O(o,function(o,i){return i.compvare?(r++,void I(n,t)):(i.addEventListener("load",function(){r++,I(n,t)}),void i.addEventListener("error",function(){e--,I(n,t)}))})};return t.init=function(t){return t.container&&(i.container=b(t.container),i.container)?(delete t.container,i.options=n(o,t),window.addEventListener("resize",function(){m()}),i.container.style.position="relative",i.elements=i.container.children,i.options.waitForImages?void j(null,function(){m()}):(m(),void j(function(){m()}))):void 0},t});